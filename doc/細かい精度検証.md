# 細かい精度検証

本ドキュメントでは、モデルの精度に関する細かい検証結果と、変更点をまとめます。
実行コマンド: `uv run python kaggle/src/main.py`

## スコアの推移

**最初の実装**
交差検証スコア: [0.68548917 0.54629022 0.54694682 0.61498029 0.65900131]
精度平均: 0.61054156

**replace_links の置換を URLTEXT に変更**
交差検証スコア: [0.68483257 0.56007879 0.54038083 0.60643890 0.66228647]
精度平均: 0.61080351
処理時間: 74.40 秒
-> 精度微増、**適用する**

**TfidfVectorizer の max_features を変更 (500, 2000, 4000 を検討、500 に設定)**
交差検証スコア: [0.67432699 0.55154301 0.53578464 0.61695138 0.67214192]
精度平均: 0.61014959
処理時間: 61.56 秒
-> 精度微低下の割に計算が速い、**適用する**

**keyword のカウント時に足切り (min_df) を導入 (10, 20, 30 を検討、20 に設定)**
交差検証スコア: [0.67367039 0.55876559 0.53447144 0.62220762 0.67148489]
精度平均: 0.61211999
処理時間: 66.97 秒
-> 精度微増、**適用する**

**location のカウント時に足切り (min_count) を導入 (5, 10, 20 を検討、10 に設定)**
交差検証スコア: [0.67235719 0.558109 0.54366382 0.62286465 0.66031537]
精度平均: 0.61146201
処理時間: 59.84 秒
-> 精度微増、**適用する**

**学習・評価処理での並列処理を有効化**
交差検証スコア: [0.67235719 0.558109 0.54366382 0.62286465 0.66031537]
精度平均: 0.61146201
処理時間: 48.65 秒
-> 処理時間大幅短縮、**適用する**

**メンションを削除ではなく、置換に変更**
交差検証スコア: [0.68023638 0.56073539 0.53250164 0.63731932 0.67542707]
精度平均: 0.61724396
処理時間: 45.61 秒
-> 精度微増、**適用する**

**countries.search_fuzzy の結果キャッシュを有効化**
交差検証スコア: [0.68023638 0.56073539 0.53250164 0.63731932 0.67542707]
精度平均: 0.61724396
処理時間: 23.75 秒
-> 処理時間大幅短縮、**適用する**

**RandomForestClassifier > class_weight="balanced"**
交差検証スコア: [0.66776100 0.55942219 0.53709783 0.63272011 0.68659658]
精度平均: 0.61671954
処理時間: 23.36 秒
-> 精度低下、適用しない

**RandomForestClassifier > max_depth を設定 (15, 20, 25 を検討、20 に設定)**
交差検証スコア: [0.65725542 0.58437295 0.60604071 0.62812089 0.71419185]
精度平均: 0.63799636
処理時間: 20.58 秒
-> 精度向上、**適用する**

**RandomForestClassifier > min_samples_leaf を設定 (1, 2, 3 を検討、1 を維持)**
交差検証スコア: [0.65725542 0.58437295 0.60604071 0.62812089 0.71419185]
精度平均: 0.63799636
処理時間: 20.58 秒
-> 最終的に変更を行っていないのでスコアも同じ

**RandomForestClassifier > n_estimators を設定 (100, 300, 500 を検討、300 に設定)**
交差検証スコア: [0.65594222 0.57977676 0.6106369 0.63337714 0.71353482]
精度平均: 0.63865357
処理時間: 25.63 秒
-> 精度向上、**適用する**

**シャッフル有交差検証に変更し、再度各種パラメータのチューニングを実施**
Train 平均: 0.87570600
Test 平均: 0.78720668
乖離 (Train - Test): 0.08849932 - (過学習の疑いあり)
処理時間: 49.56 秒
-> 精度向上、**適用する**

**キーワードを特徴量から削除**
Train 平均: 0.86900703
Test 平均: 0.78825836
乖離 (Train - Test): 0.08074868 - (過学習の疑いあり)
処理時間: 66.29 秒
-> 精度向上したが、提出時スコアが低下したため適用しない。ただし検討の余地は大いにあると感じた。

**TfidfVectorizer の max_features を 1200 に変更**
Train 平均: 0.87521344
Test 平均: 0.78891487
乖離 (Train - Test): 0.08629857 - (過学習の疑いあり)
処理時間: 62.22 秒
-> 精度向上、**適用する**

**RandomForestClassifier > max_features を設定 (sqrt, log2, None を検討、log2 に設定)**
Train 平均: 0.84608566
Test 平均:  0.79049269
乖離 (Train - Test): 0.05559297 - (過学習の疑いあり)
処理時間: 33.74 秒
-> 精度向上、**適用する**

**さらに各パラメータ再調整**
Train 平均: 0.85327730
Test 平均:  0.79351348
乖離 (Train - Test): 0.05976382 - (過学習の疑いあり)
処理時間: 35.76 秒
-> 精度向上、**適用する**

## 別アプローチを検討する場合

- RandomForestClassifier 以外のモデルを試す
- BERT などの事前学習済み言語モデルを使う
- keyword も word2vec や FastText でベクトル化する
- Location をジオコーディングして緯度経度情報などに変換する
